# Load and Explore a Dataset {#lesson02}

:::cdi-message
- **ID:** DS-L02
- **Type:** Lesson
- **Audience:** Public
- **Theme:** Data loading, structure inspection, and initial exploration
:::

Every data science project begins with understanding the dataset.

In this guide, code is executed inside Quarto chapter files (`.qmd`). When you render the book, Quarto runs the Python chunks and embeds the results directly into the page.

In this lesson, you will:

- Load a dataset into a pandas DataFrame  
- Inspect its structure and data types  
- Generate summary statistics  
- Create initial visualizations  
- Save the dataset for reuse in later lessons  

---

## Chapter Initialization

```{python}
#| label: 02-chapter-init

from cdi_viz.theme import cdi_notebook_init, show_and_save_mpl

cdi_notebook_init(chapter="02", title_x=0)
```

---

## Load the Dataset

We load Iris using scikit-learn, convert it into a DataFrame, rename columns to `snake_case`, then save it to disk.

```{python}
#| label: 02-load-iris

import pandas as pd
from sklearn.datasets import load_iris

iris = load_iris()

df = pd.DataFrame(iris.data, columns=iris.feature_names)
df["species"] = pd.Categorical.from_codes(iris.target, iris.target_names)

df.columns = ["sepal_length", "sepal_width", "petal_length", "petal_width", "species"]

df.head()
```

---

## Save the Dataset for Future Lessons

We store datasets in `data/` throughout this course.

```{python}
#| label: 02-save-iris

from pathlib import Path

Path("data").mkdir(exist_ok=True)
df.to_csv("data/iris.csv", index=False)

print("Saved dataset to: data/iris.csv")
```

---

## Inspect the Dataset Structure

```{python}
#| label: 02-inspect-structure

print("Columns:")
print(df.columns.tolist())

print("\nShape (rows, cols):")
print(df.shape)

print("\nData types:")
print(df.dtypes)
```

---

## Summary Statistics

```{python}
#| label: 02-summary-statistics

df.describe()
```

---

## Basic Exploratory Visualizations

At this stage, visuals are used to inspect and spot-check the dataset.

### Histograms of Numeric Features

```{python}
#| label: 02-histograms
#| fig-cap: "Iris — Histograms of Numeric Features"

import matplotlib.pyplot as plt

df[["sepal_length", "sepal_width", "petal_length", "petal_width"]].hist(
    figsize=(10, 7),
    bins=12
)
plt.suptitle("Iris — Histograms of Numeric Features", y=1.02)
plt.tight_layout()

show_and_save_mpl()
```

### Scatter: sepal_length vs petal_length

```{python}
#| label: 02-scatter-sepal-vs-petal
#| fig-cap: "Iris — Sepal Length vs Petal Length"

fig, ax = plt.subplots(figsize=(8, 5))
ax.scatter(df["sepal_length"], df["petal_length"], alpha=0.7)
ax.set_xlabel("sepal_length")
ax.set_ylabel("petal_length")
ax.grid(True, alpha=0.2)

show_and_save_mpl(fig)
```

### Pairplot by Species

```{python}
#| label: 02-pairplot-by-species
#| fig-cap: "Iris — Pairplot by Species"

import seaborn as sns

g = sns.pairplot(df, hue="species", corner=True, plot_kws={"alpha": 0.7})
g.fig.suptitle("Iris — Pairplot by Species", y=1.02)

show_and_save_mpl(g.fig)
```

---

## Exercise

- Print the last five rows of the dataset  
- Count how many rows exist for each species  
- Create a new feature called `petal_area` (`petal_length` × `petal_width`) and print the first five rows  

```{python}
#| label: 02-exercise

print("Last 5 rows:")
print(df.tail())

print("\nRows per species:")
print(df["species"].value_counts())

df["petal_area"] = df["petal_length"] * df["petal_width"]

print("\nWith petal_area:")
print(df.head())
```

---

## Summary

- You loaded Iris using scikit-learn and converted it to a pandas DataFrame  
- You standardized column names to `snake_case`  
- You saved the dataset to `data/iris.csv` for future lessons  
- You inspected structure, summary statistics, and created starter visuals  
